<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>경영정보시스템 맞춤형 실전 테스트</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Slate background, Indigo/Blue accents for a modern, functional feel -->
    <!-- Application Structure Plan: The SPA flow is revised. 1) Home View: Users can now multi-select chapters using checkbox-like cards. A "Generate Quiz" button becomes active when at least one chapter is chosen. This provides greater flexibility for custom practice sessions (e.g., mid-term scope, final scope, or focusing on weak chapters). 2) Quiz View: On generation, presents a shuffled set of questions from all selected chapters. 3) Results View: Same grading and review functionality. This new structure better serves the user's need for flexible, targeted study by moving from a fixed chapter test to a dynamic quiz generation model. -->
    <!-- Visualization & Content Choices: Source Report (51 MIS questions) -> Goal (Customizable multi-chapter self-testing) -> Presentation Method (HTML/Tailwind views) -> Interaction (Multi-select chapter cards, a "Generate Quiz" button, interactive quiz form) -> Justification (This workflow is more powerful for exam preparation, allowing users to combine chapters as they would for a cumulative exam.) -> Library/Method (JS logic for state management of selected chapters and quiz generation). -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body { font-family: 'Noto Sans KR', sans-serif; }
        .view { display: none; }
        .view.active { display: block; }
        .chapter-card { transition: all 0.2s ease-in-out; border: 2px solid transparent; }
        .chapter-card.selected { border-color: #4f46e5; background-color: #eef2ff; color: #1e1b4b; }
        .chapter-card:not(.selected):hover { transform: translateY(-4px); box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1); }
        .mcq-option.selected { background-color: #e0e7ff; border-color: #4f46e5; }
        .result-card.correct { border-left-color: #16a34a; }
        .result-card.incorrect { border-left-color: #dc2626; }
        .result-card.manual { border-left-color: #f59e0b; }
        #generate-quiz-btn:disabled { cursor: not-allowed; }
        #password-modal { transition: opacity 0.3s; }
    </style>
</head>
<body class="bg-slate-100 text-slate-800">

    <div class="container mx-auto p-4 sm:p-6 lg:p-8 min-h-screen flex flex-col">

        <!-- Home View: Chapter Selection -->
        <div id="home-view" class="view active flex-grow flex flex-col">
            <header class="text-center mb-8">
                <h1 class="text-4xl font-bold text-slate-900">경영정보시스템 맞춤형 테스트</h1>
                <p class="mt-3 text-lg text-slate-600">시험 볼 챕터를 모두 선택한 후, '문제 출제' 버튼을 누르세요.</p>
            </header>
            <main id="chapter-selection" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 flex-grow">
                <!-- Chapter cards will be inserted here by JS -->
            </main>
            <div class="mt-10 text-center">
                <button id="generate-quiz-btn" class="px-10 py-4 bg-indigo-600 text-white rounded-lg font-bold text-xl hover:bg-indigo-700 transition shadow-lg disabled:bg-indigo-300 disabled:opacity-70" disabled>
                    문제 출제
                </button>
            </div>
        </div>

        <!-- Quiz View -->
        <div id="quiz-view" class="view">
            <header class="flex justify-between items-center mb-6 pb-4 border-b border-slate-300">
                <h1 id="quiz-title" class="text-3xl font-bold text-slate-900"></h1>
                <button id="back-to-home" class="px-4 py-2 bg-slate-200 text-slate-700 rounded-lg font-semibold hover:bg-slate-300 transition">처음으로</button>
            </header>
            <div id="quiz-container" class="space-y-8">
                <!-- Quiz questions will be inserted here by JS -->
            </div>
            <div class="mt-10 text-center">
                <button id="grade-button" class="px-8 py-3 bg-indigo-600 text-white rounded-lg font-bold text-lg hover:bg-indigo-700 transition shadow-lg">채점하기</button>
            </div>
        </div>

        <!-- Results View -->
        <div id="results-view" class="view">
            <header class="text-center mb-10">
                <h1 class="text-4xl font-bold text-slate-900">채점 결과</h1>
                <p id="results-summary" class="mt-3 text-2xl font-semibold text-indigo-600"></p>
            </header>
            <div id="results-container" class="space-y-6">
                <!-- Result details will be inserted here by JS -->
            </div>
            <div class="mt-10 text-center">
                 <button id="restart-quiz" class="px-6 py-3 bg-indigo-600 text-white rounded-lg font-bold hover:bg-indigo-700 transition">다시 풀기</button>
                 <button id="go-home" class="ml-4 px-6 py-3 bg-slate-200 text-slate-700 rounded-lg font-bold hover:bg-slate-300 transition">처음으로</button>
            </div>
        </div>
        
        <!-- Admin View -->
        <div id="admin-view" class="view">
             <header class="text-center mb-8">
                <h1 class="text-4xl font-bold text-slate-900">관리자 모드</h1>
                <p class="mt-3 text-lg text-slate-600">문제 데이터를 직접 수정, 추가, 백업할 수 있습니다.</p>
            </header>
            <div class="bg-white p-6 rounded-lg shadow-md">
                <h2 class="text-xl font-bold mb-2">문제 데이터 (JSON 형식)</h2>
                <p class="text-sm text-slate-500 mb-4">아래 텍스트를 직접 수정하여 문제를 변경할 수 있습니다. 새로운 문제를 추가하려면 기존 문제의 형식을 복사하여 붙여넣고 내용을 수정하세요.</p>
                <textarea id="data-editor" class="w-full h-96 p-3 border border-slate-300 rounded-md font-mono text-sm"></textarea>
                <div class="flex flex-wrap gap-4 mt-4">
                    <button id="save-data-btn" class="px-6 py-2 bg-green-600 text-white rounded-lg font-bold hover:bg-green-700 transition">저장하기</button>
                    <button id="download-data-btn" class="px-6 py-2 bg-blue-600 text-white rounded-lg font-bold hover:bg-blue-700 transition">데이터 백업</button>
                    <button onclick="document.getElementById('upload-data-input').click()" class="px-6 py-2 bg-orange-500 text-white rounded-lg font-bold hover:bg-orange-600 transition">데이터 복원</button>
                    <input type="file" id="upload-data-input" class="hidden" accept=".json">
                    <button id="exit-admin-btn" class="px-6 py-2 bg-slate-500 text-white rounded-lg font-bold hover:bg-slate-600 transition">나가기</button>
                </div>
                <p id="save-status" class="mt-4 text-green-600 font-semibold"></p>
            </div>
        </div>

    </div>
    
    <footer class="text-center py-4">
        <button id="admin-mode-btn" class="text-sm text-slate-500 hover:text-indigo-600">관리자 모드</button>
    </footer>

    <!-- Password Modal -->
    <div id="password-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-white p-8 rounded-lg shadow-xl w-full max-w-sm">
            <h2 class="text-2xl font-bold mb-4">관리자 암호 입력</h2>
            <input type="password" id="password-input" class="w-full p-2 border border-slate-300 rounded-md mb-4">
            <p id="password-error" class="text-red-500 text-sm mb-4 hidden">암호가 틀렸습니다.</p>
            <div class="flex justify-end gap-4">
                <button id="password-cancel" class="px-4 py-2 bg-slate-200 rounded-lg font-semibold">취소</button>
                <button id="password-submit" class="px-4 py-2 bg-indigo-600 text-white rounded-lg font-semibold">확인</button>
            </div>
        </div>
    </div>

    <script>
        // Default data in case local storage is empty
        const initialQuestionData = [
            { "id": 1, "type": "주관식", "chapter": "Chapter 05", "text": "현실 세계에 관한 데이터를 컴퓨터에 바로 저장할 수 없기 때문에, 무엇을 어떻게 표현해야 할지 개념적으로 요약하는 과정을 무엇이라고 하는가?", "answer": "모형화 (Modeling)" },
            { "id": 2, "type": "객관식", "chapter": "Chapter 06", "text": "온라인 거래 처리(OLTP)와 온라인 분석 처리(OLAP)에 대한 비교 설명으로 옳은 것을 모두 고른 것은?", "options": ["가, 나, 다", "가, 다, 라", "나, 다, 라", "가, 나, 다, 라", "정답없음"], "answer": 4, "explanation": "보기 가, 나, 다, 라는 모두 OLTP와 OLAP의 특징을 올바르게 비교한 것이다." },
            { "id": 3, "type": "서술형", "chapter": "Chapter 07", "text": "기존의 마케팅과 CRM(고객관계관리)의 가장 큰 차이점을 '목표'와 '대상'의 관점에서 서술하시오.", "answer": "기존 마케팅은 불특정 다수를 대상으로 상품을 판매하는 것을 목표로 하지만, CRM은 이미 확보된 특정 고객을 대상으로 지속적인 관계를 유지하여 고객의 평생 가치를 극대화하는 것을 목표로 한다." },
            { "id": 4, "type": "주관식", "chapter": "Chapter 08", "text": "어떤 기업이 특정 사업 분야에서 철수하려고 할 때, 그 분야에서 쉽게 빠져나오지 못하게 하는 요인을 무엇이라고 하는가?", "answer": "철수장벽 (Barriers to Exit)" },
            { "id": 5, "type": "객관식", "chapter": "Chapter 06", "text": "비즈니스 인텔리전스(BI)의 3가지 주요 구성요소로 옳지 않은 것은?", "options": ["데이터 웨어하우스와 같은 데이터 관리 공간", "데이터 마이닝, OLAP과 같은 업무 분석 도구", "대시보드, 시각화 툴과 같은 사용자 인터페이스", "기업 내부 데이터의 정확성을 검증하는 데이터베이스 감사(Audit) 시스템", "정답없음"], "answer": 3, "explanation": "데이터베이스 감사는 일반적인 데이터 관리 활동일 수는 있으나, BI를 구성하는 3대 핵심 요소(데이터 관리, 업무 분석 도구, 사용자 인터페이스)에는 포함되지 않는다." },
            { "id": 6, "type": "주관식", "chapter": "Chapter 06", "text": "BI의 질의 및 보고서 작성 기능에서, 사용자가 요약된 형태의 정보에서 점차 상세한 수준의 정보로 다차원적인 접근을 가능하게 하는 기능을 무엇이라고 하는가?", "answer": "드릴 다운 (Drill down)" },
            { "id": 7, "type": "주관식", "chapter": "Chapter 06", "text": "데이터 웨어하우스의 한 부분으로, 마케팅이나 판매와 같이 특정 주제나 부서의 데이터에 초점을 맞춘 소규모 데이터 웨어하우스를 (           )(이)라고 한다.", "answer": "데이터 마트 (Data Mart)" },
            { "id": 8, "type": "주관식", "chapter": "Chapter 08", "text": "마이클 포터가 제시한 세 가지 본원적 경쟁전략은 비용 우위 전략, 차별화 전략, 그리고 (           )이다.", "answer": "집중화 전략" },
            { "id": 9, "type": "주관식", "chapter": "Chapter 06", "text": "기업 내외부에 축적된 데이터를 기반으로 경영 정보를 분석하고 예측하여, 의사결정을 지원하는 정보 시스템 또는 프로세스를 무엇이라고 하는가?", "answer": "비즈니스 인텔리전스 (BI, Business Intelligence)" },
            { "id": 10, "type": "주관식", "chapter": "Chapter 07", "text": "의류의 기획, 디자인, 생산, 유통, 판매까지의 전 과정을 제조회사가 직접 관리하는 의류 전문점을 무엇이라고 하는가? (영문 약어로 답변)", "answer": "SPA" },
            { "id": 11, "type": "서술형", "chapter": "Chapter 06", "text": "데이터 웨어하우스의 특징 4가지를 모두 쓰시오.", "answer": "1. 주제 중심의 데이터 (Subject-oriented)<br>2. 통합적 데이터 (Integrated)<br>3. 시간에 따라 데이터가 적재되는 시간 의존적 데이터 (Time-variant)<br>4. 비휘발성 데이터 (Non-volatile)" },
            { "id": 12, "type": "객관식", "chapter": "Chapter 05", "text": "다음 중 데이터베이스 시스템(Database System)의 4가지 구성요소로 올바르게 짝지어진 것은?", "options": ["데이터, 데이터베이스, 데이터베이스 관리시스템(DBMS), 응용 프로그램", "데이터베이스(DB), 데이터베이스 관리시스템(DBMS), 하드웨어, 사용자", "데이터베이스(DB), 데이터베이스 관리시스템(DBMS), 소프트웨어, 사용자", "데이터, 정보, 지식, 데이터베이스", "정답없음"], "answer": 1 },
            { "id": 13, "type": "주관식", "chapter": "Chapter 08", "text": "고객의 니즈(needs)를 충족시켜 고객 만족도를 높이는 데 초점을 맞추는 경쟁 우위 전략을 (           ) 전략이라고 한다.", "answer": "고객 전략" },
            { "id": 14, "type": "주관식", "chapter": "Chapter 06", "text": "사용자가 원하는 결과를 한눈에 볼 수 있도록 그래프, 차트, 표 등을 사용하여 정보를 시각적으로 구성하고 표현하는 BI의 사용자 인터페이스 도구를 무엇이라고 하는가?", "answer": "대시보드 (Dashboard)" },
            { "id": 15, "type": "주관식", "chapter": "Chapter 06", "text": "의사결정 지원을 위해 여러 데이터베이스에서 수집된 데이터를 통합하여 저장하는 공간으로, 과거와 현재 데이터를 모두 포함하며 다차원적 분석이 가능한 구조를 가진 것을 무엇이라고 하는가?", "answer": "데이터 웨어하우스 (Data Warehouse)" },
            { "id": 16, "type": "객관식", "chapter": "Chapter 08", "text": "마이클 포터의 가치사슬 모형(Value Chain Model)에서 본원적 활동(Primary Activities)에 해당하지 않는 것은?", "options": ["내부 물류", "제조, 생산", "인적 자원 관리", "마케팅, 영업", "정답없음"], "answer": 2, "explanation": "인적 자원 관리는 본원적 활동을 지원하는 지원 활동(Support Activities)에 해당한다." },
            { "id": 17, "type": "주관식", "chapter": "Chapter 05", "text": "여러 개의 데이터베이스 작업으로 이루어진 논리적 작업 단위로, 모든 작업이 성공적으로 수행되든지 아니면 모두 실패하여 원래 상태로 되돌려지는 특징을 갖는 기능을 무엇이라고 하는가?", "answer": "트랜잭션 (Transaction)" },
            { "id": 18, "type": "주관식", "chapter": "Chapter 08", "text": "기존의 정보시스템에 정보기술과 경쟁전략 개념을 융합하여 기업의 경쟁우위를 확보하고 부가가치를 창출하는 시스템을 무엇이라고 하는가? (영문 약어로도 가능)", "answer": "전략정보시스템 (SIS, Strategic Information System)" },
            { "id": 19, "type": "주관식", "chapter": "Chapter 05", "text": "개체-관계 다이어그램(ERD)에서, 관계의 '전체 참여'는 ( A )(으)로, '부분 참여'는 ( B )(으)로 표기한다.", "answer": "A: 두 줄, B: 한 줄" },
            { "id": 20, "type": "주관식", "chapter": "Chapter 07", "text": "기업 내 생산, 물류, 재무, 회계, 구매, 재고 등 경영 활동의 프로세스들을 통합적으로 연계해 관리하여, 기업의 정보들을 공유하고 빠른 의사결정을 지원하는 시스템을 (           )(이)라고 한다.", "answer": "전사적자원관리 (ERP, Enterprise Resource Planning)" },
            { "id": 21, "type": "주관식", "chapter": "Chapter 05", "text": "데이터베이스 내의 데이터가 허가되지 않은 방법으로 입력되거나 수정될 수 없도록 보호하여 유효성을 유지하는 성질을 무엇이라고 하는가?", "answer": "데이터 무결성 (Integrity)" },
            { "id": 22, "type": "객관식", "chapter": "Chapter 06", "text": "데이터 마이닝의 기법에 대한 설명으로 가장 옳지 않은 것은?", "options": ["**연관성 분석:** '기저귀와 맥주' 사례처럼, 데이터 사이에 존재하는 연관 규칙을 발견하는 기법이다.", "**군집 분석:** 데이터의 특징을 기준으로 유사한 항목들을 그룹으로 묶는 기법이다.", "**예측 모델링:** 데이터의 과거 패턴을 기반으로 미래의 특정 속성 값을 예측하는 모델을 만든다.", "**이상치 탐지:** 데이터의 전체적인 분포를 파악하여 데이터의 평균과 표준편차를 구하는 기법이다.", "정답없음"], "answer": 3, "explanation": "이상치 탐지(Anomaly Detection)는 기존 데이터 패턴과 상이한, 즉 특이한 데이터를 찾아내는 기법이다. 데이터의 평균이나 표준편차를 구하는 것은 일반적인 통계 분석에 해당한다." },
            { "id": 23, "type": "서술형", "chapter": "Chapter 08", "text": "정보기술을 이용해 획득한 기업의 경쟁우위가 장기간 지속되기 어려운 이유와, 그럼에도 불구하고 시장에 먼저 진입한 기업이 얻는 이점은 무엇인지 서술하시오.", "answer": "정보기술을 이용한 경쟁우위는 경쟁사들이 유사한 기술이나 시스템을 빠르게 모방하여 도입할 수 있기 때문에 장기간 지속되기 어렵다. 그럼에도 불구하고, 시장에 먼저 진입한 기업은 다수의 신규 고객을 확보하고 혁신적인 시장 리더라는 이미지를 얻는 추가적인 이점을 누릴 수 있다." },
            { "id": 24, "type": "주관식", "chapter": "Chapter 05", "text": "각 업무별로 필요한 파일을 사용자가 직접 프로그램을 통해 관리하던 초기의 데이터 처리 방식을 무엇이라고 하는가?", "answer": "파일 처리 시스템 (File Processing System)" },
            { "id": 25, "type": "주관식", "chapter": "Chapter 07", "text": "CRM의 주요 기능 중, 기존에 특정 상품을 구매했던 고객에게 업그레이드된 상위 상품의 구매를 유도하는 판매 방법을 무엇이라고 하는가?", "answer": "업셀링 (Up-Selling)" },
            { "id": 26, "type": "주관식", "chapter": "Chapter 05", "text": "개체-관계 모델에서, 다른 개체에 독립적으로 존재하지 못하고 상위 개체(정규 개체)가 있어야만 존재할 수 있는 개체를 무엇이라고 하는가?", "answer": "약한 개체 (Weak Entity)" },
            { "id": 27, "type": "주관식", "chapter": "Chapter 08", "text": "기업의 전통적인 운영 방식을 새로운 방식으로 획기적으로 바꾸거나, 새로운 제품 및 서비스를 개발하는 경쟁 우위 전략을 무엇이라고 하는가?", "answer": "혁신 전략 (Innovation Strategy)" },
            { "id": 28, "type": "객관식", "chapter": "Chapter 08", "text": "다음 중 가치사슬 모형의 지원 활동(Support Activities)에 해당하지 **않는** 것은?", "options": ["조달 활동", "기술 개발", "인적 자원 관리", "기업 하부구조", "정답없음"], "answer": 4, "explanation": "보기 ①, ②, ③, ④는 모두 가치사슬 모형의 지원 활동에 해당하므로, '해당하지 않는 것'은 없다." },
            { "id": 29, "type": "객관식", "chapter": "Chapter 08", "text": "마이클 포터의 5가지 경쟁세력 모형(Five Forces Model)에 포함되지 않는 것은?", "options": ["신규 진입 기업의 위협", "공급자의 교섭력", "구매자의 교섭력", "정부의 정책 및 규제", "정답없음"], "answer": 3, "explanation": "정부의 정책 및 규제는 기업 환경에 영향을 주는 중요한 요인이지만, 포터의 5가지 경쟁세력 모형에는 직접적으로 포함되지 않는다." },
            { "id": 30, "type": "서술형", "chapter": "Chapter 07", "text": "공급사슬관리 기법 중 ECR과 QR의 차이점을 각각 적용되는 '산업 분야'를 중심으로 서술하시오.", "answer": "ECR(Efficient Consumer Response)은 주로 식품 산업의 공급업체와 유통업체 간의 협력에 적용되는 기법이다. 반면, QR(Quick Response)은 주로 의류 산업에서 소비자의 다양한 욕구를 신속하게 파악하여 제품을 공급하는 방식에 적용된다." },
            { "id": 31, "type": "객관식", "chapter": "Chapter 08", "text": "마이클 포터의 본원적 경쟁전략에 대한 설명으로 가장 **옳지 않은** 것은?", "options": ["**비용 우위 전략**은 산업 전반의 넓은 시장을 대상으로 원가 절감을 통해 경쟁 우위를 확보하는 것이다.", "**차별화 전략**은 제품이나 서비스에 독특한 가치를 부여하여 경쟁사와 구별되게 만드는 전략이다.", "**집중화 전략**은 특정 세분시장(틈새시장)에 경영 자원을 집중하여 경쟁 우위를 확보하는 것이다.", "**원가 집중화 전략**은 산업 전반의 모든 구매자를 대상으로 가장 낮은 가격을 제공하는 데 집중하는 전략이다.", "정답없음"], "answer": 3, "explanation": "원가 집중화 전략은 '산업 전반의 모든 구매자'가 아닌 '좁은 범위의 특정 구매자 집단(틈새시장)'을 대상으로 저비용을 추구하는 전략이다." },
            { "id": 32, "type": "주관식", "chapter": "Chapter 07", "text": "기업이 고객과 관련된 내·외부 자료를 분석·통합하여 고객 특성에 맞게 마케팅 활동을 지원하고, 고객과의 지속적인 관계를 유지하여 고객 가치를 극대화하는 시스템을 (           )(이)라고 한다.", "answer": "고객관계관리 (CRM, Customer Relationship Management)" },
            { "id": 33, "type": "주관식", "chapter": "Chapter 08", "text": "가치사슬 모형에서, 본원적 활동이 원활히 이루어지도록 간접적으로 지원하는 4가지 활동은 조달 활동, 기술 개발, 인적 자원 관리, 그리고 (           )이다.", "answer": "기업 하부구조 (Firm Infrastructure)" },
            { "id": 34, "type": "서술형", "chapter": "Chapter 06", "text": "OLTP(온라인 거래 처리)와 OLAP(온라인 분석 처리)의 차이점을 '목적'과 '사용 데이터'의 관점에서 서술하시오.", "answer": "**목적:** OLTP는 일상의 반복적인 거래 업무를 빠르고 효율적으로 처리하는 것이 목적이지만, OLAP은 사용자가 복잡하고 다양한 질문에 대해 분석하여 의사결정을 지원하는 것이 목적이다.<br>**사용 데이터:** OLTP는 주로 실시간으로 갱신되는 운영 데이터베이스(DB)를 사용하고, OLAP은 의사결정을 위해 과거 데이터까지 통합된 데이터 웨어하우스(DW)나 데이터 마트의 데이터를 사용한다." },
            { "id": 35, "type": "주관식", "chapter": "Chapter 06", "text": "온라인 분석 처리(OLAP)에서 다차원적인 데이터를 분석하기 위한 두 가지 기법은 (           )와/과 (           )이다.", "answer": "다이스(Dice), 슬라이스(Slice)" },
            { "id": 36, "type": "주관식", "chapter": "Chapter 08", "text": "고객이 한 공급자에서 다른 공급자로 거래처를 변경할 때 발생하는 경제적·시간적 비용을 (           )(이)라고 한다.", "answer": "전환비용 (Switching Cost)" },
            { "id": 37, "type": "서술형", "chapter": "Chapter 06", "text": "데이터 마이닝의 4가지 기법을 쓰시오.", "answer": "1. 연관 분석 (Association Analysis)<br>2. 군집 분석 (Cluster Analysis)<br>3. 예측 모델링 (Predictive Modeling)<br>4. 이상치 탐지 (Anomaly Detection)" },
            { "id": 38, "type": "주관식", "chapter": "Chapter 05", "text": "데이터베이스 관리시스템(DBMS)의 종류를 2가지 쓰시오.", "answer": "ORACLE(오라클), MySQL" },
            { "id": 39, "type": "주관식", "chapter": "Chapter 08", "text": "기업의 경쟁전략을 설명하는 마이클 포터의 3가지 개념은 경쟁세력 모형, 본원적 전략, 그리고 (           ) 모형이다.", "answer": "가치사슬" },
            { "id": 40, "type": "주관식", "chapter": "Chapter 07", "text": "정보기술을 이용하여 기업의 업무 흐름을 분석하고 최적화함으로써 반복적이거나 불필요한 과정을 제거하는 경영혁신 기법을 무엇이라고 하는가? (영문 약어로도 가능)", "answer": "업무 재설계 (BPR, Business Process Reengineering)" },
            { "id": 41, "type": "주관식", "chapter": "Chapter 05", "text": "개체-관계 모델에서, 관계에 참여하는 개체 타입의 모든 구성원이 관계에 참여하는 것을 ( A )(이)라고 하고, 일부 구성원만 참여하는 것을 ( B )(이)라고 한다.", "answer": "A: 전체 참여, B: 부분 참여" },
            { "id": 42, "type": "주관식", "chapter": "Chapter 06", "text": "디지털 환경에서 생성되는 데이터로 그 규모가 방대하고, 생성 주기가 짧으며, 수치뿐 아니라 문자와 영상 등 비정형 데이터를 포함하는 대규모 데이터를 (           )(이)라고 한다.", "answer": "빅데이터 (Big Data)" },
            { "id": 43, "type": "주관식", "chapter": "Chapter 08", "text": "내부 업무의 프로세스를 개선하여 동종 경쟁사에 비해 업무를 더 쉽고 생산적으로 수행하도록 하는 경쟁 우위 전략을 (           ) 전략이라고 한다.", "answer": "운영효과성 전략 (Operational Effectiveness Strategy)" },
            { "id": 44, "type": "객관식", "chapter": "Chapter 07", "text": "다음 중 전사적자원관리(ERP) 시스템의 주요 특징으로 가장 거리가 **먼** 것은?", "options": ["업무 프로세스의 통합화", "BPR(업무 재설계) 실현", "글로벌화에 대한 대응", "시스템의 폐쇄성 및 종속성", "정답없음"], "answer": 3, "explanation": "ERP 시스템은 특정 하드웨어와 운영체제에 의존하지 않는 개방성(Openness)을 특징으로 하여 확장 및 연계가 용이하다." },
            { "id": 45, "type": "주관식", "chapter": "Chapter 07", "text": "제품이나 정보가 생산자에서부터 최종 소비자에게 이르는 자재 조달, 제품 생산, 유통, 판매의 전 과정을 최적화하여 효율적인 처리를 지원하는 시스템을 (           )(이)라고 한다.", "answer": "공급사슬관리 (SCM, Supply Chain Management)" },
            { "id": 46, "type": "객관식", "chapter": "Chapter 05", "text": "개체-관계 다이어그램(ERD)의 구성요소 표기법으로 옳지 않은 것은?", "options": ["개체(Entity)는 직사각형으로 표현한다.", "관계(Relationship)는 마름모로 표현한다.", "속성(Attribute)은 타원형으로 표현한다.", "전체 참여(Total Participation)는 한 줄 실선으로 표현한다.", "정답없음"], "answer": 3, "explanation": "전체 참여는 두 줄 실선으로, 부분 참여는 한 줄 실선으로 표현한다." },
            { "id": 47, "type": "주관식", "chapter": "Chapter 06", "text": "데이터 항목 간의 연관성 규칙을 발견하는 연관성 분석은 월마트의 구매 패턴 분석 사례로 인해 다른 말로 '(           ) 분석'이라고도 불린다.", "answer": "장바구니 분석" },
            { "id": 48, "type": "주관식", "chapter": "Chapter 06", "text": "일상의 반복적인 업무를 수행하는 시스템에서 데이터를 조회하거나 저장하는 등의 작업을 처리하는 방식을 (           )(이)라고 한다. (영문 약어로 답변)", "answer": "OLTP" },
            { "id": 49, "type": "주관식", "chapter": "Chapter 07", "text": "CRM의 주요 기능 중, 기존 상품을 구매한 고객이 그 상품과 연관된 다른 상품을 구매하도록 유도하는 판매 방법을 (           )(이)라고 한다.", "answer": "교차판매 (Cross-Selling)" },
            { "id": 50, "type": "주관식", "chapter": "Chapter 05", "text": "사용자나 응용 프로그램이 데이터베이스에 접근하여 데이터를 정의, 조작, 제어할 수 있도록 해주는 소프트웨어를 무엇이라고 하는가?", "answer": "데이터베이스 관리시스템 (DBMS)" },
            { "id": 51, "type": "주관식", "chapter": "Chapter 07", "text": "기업이 고객과 관련된 내·외부 자료를 분석·통합하여 고객 특성에 맞게 마케팅 활동을 지원하고, 고객과의 지속적인 관계를 유지하여 고객 가치를 극대화하는 시스템을 (           )(이)라고 한다.", "answer": "고객관계관리 (CRM, Customer Relationship Management)" }
        ];
        
        let questionData = [];

        const ADMIN_PASSWORD = 'mis'; // 관리자 암호를 여기에 설정

        const state = {
            currentView: 'home',
            selectedChapters: [],
            currentQuizQuestions: [],
            userAnswers: {}
        };

        const views = {
            home: document.getElementById('home-view'),
            quiz: document.getElementById('quiz-view'),
            results: document.getElementById('results-view'),
            admin: document.getElementById('admin-view')
        };
        
        const chapterSelectionContainer = document.getElementById('chapter-selection');
        const generateQuizBtn = document.getElementById('generate-quiz-btn');
        const quizContainer = document.getElementById('quiz-container');
        const resultsContainer = document.getElementById('results-container');
        const dataEditor = document.getElementById('data-editor');
        const saveStatus = document.getElementById('save-status');
        
        const quizTitle = document.getElementById('quiz-title');
        const gradeButton = document.getElementById('grade-button');
        const resultsSummary = document.getElementById('results-summary');

        function showView(viewId) {
            Object.values(views).forEach(v => v.classList.remove('active'));
            views[viewId].classList.add('active');
            state.currentView = viewId;
        }

        function toggleChapterSelection(chapter, cardElement) {
            const index = state.selectedChapters.indexOf(chapter);
            if (index > -1) {
                state.selectedChapters.splice(index, 1);
                cardElement.classList.remove('selected');
            } else {
                state.selectedChapters.push(chapter);
                cardElement.classList.add('selected');
            }
            generateQuizBtn.disabled = state.selectedChapters.length === 0;
        }

        function createChapterCards() {
            const chapters = [...new Set(questionData.map(q => q.chapter))].sort();
            chapterSelectionContainer.innerHTML = '';
            chapters.forEach((chapter) => {
                const questionCount = questionData.filter(q => q.chapter === chapter).length;
                const card = document.createElement('div');
                card.className = `chapter-card p-6 rounded-lg text-slate-800 bg-white shadow-sm cursor-pointer`;
                card.dataset.chapter = chapter;
                card.innerHTML = `<h3 class="text-xl font-bold">${chapter.replace('Chapter 0', 'Chapter ')}</h3><p class="mt-2 text-slate-500">${questionCount} 문제</p>`;
                card.addEventListener('click', () => toggleChapterSelection(chapter, card));
                chapterSelectionContainer.appendChild(card);
            });
        }
        
        function startQuiz() {
            if (state.selectedChapters.length === 0) return;
            state.userAnswers = {};
            const questions = questionData.filter(q => state.selectedChapters.includes(q.chapter));
            state.currentQuizQuestions = questions.sort(() => Math.random() - 0.5);
            const chapterNames = state.selectedChapters.map(c => c.replace('Chapter 0', '')).sort().join(', ');
            quizTitle.textContent = `Chapter ${chapterNames} 종합 테스트`;
            renderQuizQuestions();
            showView('quiz');
        }

        function renderQuizQuestions() {
            quizContainer.innerHTML = '';
            state.currentQuizQuestions.forEach((q, index) => {
                const questionEl = document.createElement('div');
                questionEl.className = 'bg-white p-6 rounded-lg shadow-sm';
                questionEl.dataset.questionId = q.id;
                let answerInputHTML = '';
                if (q.type === '객관식') {
                    const optionsHTML = q.options.map((opt, optIndex) => `
                        <label class="mcq-option block p-3 border rounded-lg cursor-pointer hover:bg-slate-100 has-[:checked]:bg-indigo-100 has-[:checked]:border-indigo-500">
                            <input type="radio" name="q-${q.id}" value="${optIndex}" class="sr-only">
                            <span class="font-medium">${optIndex + 1}.</span> ${opt.replace(/\*\*/g, '')}
                        </label>`).join('');
                    answerInputHTML = `<div class="mt-4 space-y-2">${optionsHTML}</div>`;
                } else if (q.type === '주관식') {
                    answerInputHTML = `<input type="text" name="q-${q.id}" class="mt-4 w-full p-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500" placeholder="정답을 입력하세요...">`;
                } else {
                    answerInputHTML = `<textarea name="q-${q.id}" rows="4" class="mt-4 w-full p-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500" placeholder="답안을 서술하세요..."></textarea>`;
                }
                questionEl.innerHTML = `<p class="text-sm font-bold text-indigo-600">문제 ${index + 1} (${q.type})</p><p class="mt-2 text-lg text-slate-800">${q.text.replace(/\*\*/g, '')}</p>${answerInputHTML}`;
                questionEl.addEventListener('click', e => {
                    if (e.target.closest('label.mcq-option')) {
                        e.target.closest('label.mcq-option').querySelector('input').checked = true;
                    }
                });
                quizContainer.appendChild(questionEl);
            });
        }

        function gradeQuiz() {
            let score = 0;
            let gradableCount = 0;
            state.currentQuizQuestions.forEach(q => {
                let userAnswer;
                if (q.type === '객관식') {
                    const selectedOption = document.querySelector(`input[name="q-${q.id}"]:checked`);
                    userAnswer = selectedOption ? parseInt(selectedOption.value) : -1;
                    state.userAnswers[q.id] = userAnswer;
                    if (userAnswer === q.answer) score++;
                    gradableCount++;
                } else if (q.type === '주관식') {
                    const input = document.querySelector(`input[name="q-${q.id}"]`);
                    userAnswer = input.value.trim();
                    state.userAnswers[q.id] = userAnswer;
                    const formattedCorrectAnswer = q.answer.replace(/\s*\(.*\)\s*/, '').toLowerCase().trim();
                    if (userAnswer.toLowerCase() === formattedCorrectAnswer) score++;
                    gradableCount++;
                } else {
                    const textarea = document.querySelector(`textarea[name="q-${q.id}"]`);
                    state.userAnswers[q.id] = textarea.value;
                }
            });
            displayResults(score, gradableCount);
        }

        function displayResults(score, gradableCount) {
            resultsSummary.textContent = gradableCount > 0 ? `자동 채점 문제 ${gradableCount}개 중 ${score}개 정답!` : '채점할 문제가 없습니다.';
            resultsContainer.innerHTML = '';
            state.currentQuizQuestions.forEach((q, index) => {
                const userAnswer = state.userAnswers[q.id];
                let resultClass = 'manual', feedbackHTML = '', resultIcon = `<span class="text-amber-500 font-bold">확인</span>`;
                if (q.type === '객관식') {
                    const isCorrect = userAnswer === q.answer;
                    resultClass = isCorrect ? 'correct' : 'incorrect';
                    resultIcon = isCorrect ? `<span class="text-green-500 font-bold">정답</span>` : `<span class="text-red-500 font-bold">오답</span>`;
                    feedbackHTML = `<p class="text-sm mt-2"><span class="font-semibold">제출 답안:</span> ${userAnswer === -1 ? '미선택' : (userAnswer + 1) + '. ' + q.options[userAnswer]}</p><p class="text-sm"><span class="font-semibold">정답:</span> ${q.answer + 1}. ${q.options[q.answer]}</p>${q.explanation && !isCorrect ? `<p class="text-sm text-slate-500 mt-1"><b>해설:</b> ${q.explanation}</p>` : ''}`;
                } else if (q.type === '주관식') {
                    const isCorrect = userAnswer.toLowerCase() === q.answer.replace(/\s*\(.*\)\s*/, '').toLowerCase().trim();
                    resultClass = isCorrect ? 'correct' : 'incorrect';
                    resultIcon = isCorrect ? `<span class="text-green-500 font-bold">정답</span>` : `<span class="text-red-500 font-bold">오답</span>`;
                    feedbackHTML = `<p class="text-sm mt-2"><span class="font-semibold">제출 답안:</span> ${userAnswer || '미입력'}</p><p class="text-sm"><span class="font-semibold">정답:</span> ${q.answer}</p>`;
                } else {
                    feedbackHTML = `<div class="mt-2 grid grid-cols-1 md:grid-cols-2 gap-4"><div><h4 class="font-semibold text-sm text-slate-600 mb-1">제출 답안</h4><p class="text-sm p-3 bg-slate-100 rounded-lg min-h-[60px]">${userAnswer || '미입력'}</p></div><div><h4 class="font-semibold text-sm text-slate-600 mb-1">모범 답안</h4><div class="text-sm p-3 bg-green-50 rounded-lg min-h-[60px]">${q.answer}</div></div></div>`;
                }
                const resultEl = document.createElement('div');
                resultEl.className = `result-card bg-white p-4 rounded-lg shadow-sm border-l-4 ${resultClass}`;
                resultEl.innerHTML = `<div class="flex justify-between items-center"><p class="font-bold text-slate-700">문제 ${index + 1}. (${q.type})</p>${resultIcon}</div><p class="mt-2 text-slate-800">${q.text.replace(/\*\*/g, '')}</p><div class="mt-3 border-t pt-3">${feedbackHTML}</div>`;
                resultsContainer.appendChild(resultEl);
            });
            showView('results');
        }
        
        function resetToHome() {
            state.selectedChapters = [];
            createChapterCards();
            generateQuizBtn.disabled = true;
            showView('home');
        }

        function loadData() {
            try {
                const savedData = localStorage.getItem('misQuizData');
                questionData = savedData ? JSON.parse(savedData) : initialQuestionData;
            } catch (e) {
                console.error("Error loading data from localStorage:", e);
                questionData = initialQuestionData;
            }
        }
        
        function saveData() {
            try {
                const editorData = JSON.parse(dataEditor.value);
                localStorage.setItem('misQuizData', JSON.stringify(editorData, null, 2));
                questionData = editorData; // Update runtime data
                saveStatus.textContent = '성공적으로 저장되었습니다!';
                setTimeout(() => { saveStatus.textContent = ''; }, 3000);
            } catch (e) {
                alert('JSON 형식이 올바르지 않습니다. 저장에 실패했습니다.');
                console.error("Error parsing or saving JSON:", e);
            }
        }

        function setupAdminMode() {
            const passwordModal = document.getElementById('password-modal');
            const passwordInput = document.getElementById('password-input');
            const passwordError = document.getElementById('password-error');

            document.getElementById('admin-mode-btn').addEventListener('click', () => {
                passwordModal.classList.remove('hidden');
            });

            document.getElementById('password-cancel').addEventListener('click', () => {
                passwordModal.classList.add('hidden');
                passwordInput.value = '';
                passwordError.classList.add('hidden');
            });

            document.getElementById('password-submit').addEventListener('click', () => {
                if (passwordInput.value === ADMIN_PASSWORD) {
                    passwordModal.classList.add('hidden');
                    passwordInput.value = '';
                    passwordError.classList.add('hidden');
                    dataEditor.value = JSON.stringify(questionData, null, 2);
                    showView('admin');
                } else {
                    passwordError.classList.remove('hidden');
                }
            });
            
            document.getElementById('save-data-btn').addEventListener('click', saveData);
            document.getElementById('exit-admin-btn').addEventListener('click', resetToHome);

            document.getElementById('download-data-btn').addEventListener('click', () => {
                const dataStr = JSON.stringify(questionData, null, 2);
                const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
                const exportFileDefaultName = 'mis_quiz_data.json';
                const linkElement = document.createElement('a');
                linkElement.setAttribute('href', dataUri);
                linkElement.setAttribute('download', exportFileDefaultName);
                linkElement.click();
            });
            
            document.getElementById('upload-data-input').addEventListener('change', (event) => {
                const file = event.target.files[0];
                if (!file) return;
                const reader = new FileReader();
                reader.onload = (e) => {
                    try {
                        const content = e.target.result;
                        dataEditor.value = content;
                        saveData(); // Automatically save after upload
                        alert('데이터 복원이 완료되었습니다. 홈 화면이 새로고침됩니다.');
                        resetToHome();
                    } catch (err) {
                        alert('파일을 읽는 데 실패했습니다. 올바른 JSON 파일인지 확인하세요.');
                    }
                };
                reader.readAsText(file);
                event.target.value = ''; // Reset input
            });
        }
        
        document.querySelectorAll('#back-to-home, #go-home').forEach(btn => btn.addEventListener('click', resetToHome));
        generateQuizBtn.addEventListener('click', startQuiz);
        gradeButton.addEventListener('click', gradeQuiz);
        document.getElementById('restart-quiz').addEventListener('click', startQuiz);

        document.addEventListener('DOMContentLoaded', () => {
            loadData();
            createChapterCards();
            setupAdminMode();
            showView('home');
        });
    </script>
</body>
</html>
```